<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ausgaben-Tracker</title>

  <!-- CSS -->
  <link rel="stylesheet" href="style.css">

  <!-- Externe Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>
<body>
  <div class="container">
    <h1>🛒 Ausgaben-Tracker</h1>

    <!-- Upload -->
    <div class="upload-section" id="uploadSection" onclick="expandUpload()">
      <div class="upload-header">
        <h3>CSV-Datei laden</h3>
      </div>
      <div class="upload-content">
        <p><strong>Laden Sie eine CSV-Datei mit allen Ihren Ausgaben hoch.</strong></p>
        <p>Erforderliche Spalten: <code>Datum,Artikel,Kategorie,Preis,Shop</code></p>
        <div class="file-input" onclick="event.stopPropagation();">
          <input type="file" id="csvFile" accept=".csv,.txt" />
          <label for="csvFile">📁 Datei auswählen</label>
        </div>
        <div style="margin: 15px 0;">oder</div>
        <div onclick="event.stopPropagation();">
          <input type="url" id="csvUrl" placeholder="https://example.com/expenses.csv" class="url-input">
          <button onclick="loadFromUrl()" class="btn">URL laden</button>
        </div>
        <div id="errorMessage"></div>
      </div>
    </div>

    <!-- Monatswahl -->
    <div id="monthSelector" class="month-selector" style="display:none;">
      <h3>Monat auswählen (2025)</h3>
      <div class="month-buttons">
        <button class="month-btn" onclick="filterByMonth('all')" data-month="all">Alle</button>
        <button class="month-btn" onclick="filterByMonth('01')" data-month="01">Jan</button>
        <button class="month-btn" onclick="filterByMonth('02')" data-month="02">Feb</button>
        <button class="month-btn" onclick="filterByMonth('03')" data-month="03">Mär</button>
        <button class="month-btn" onclick="filterByMonth('04')" data-month="04">Apr</button>
        <button class="month-btn" onclick="filterByMonth('05')" data-month="05">Mai</button>
        <button class="month-btn" onclick="filterByMonth('06')" data-month="06">Jun</button>
        <button class="month-btn" onclick="filterByMonth('07')" data-month="07">Jul</button>
        <button class="month-btn" onclick="filterByMonth('08')" data-month="08">Aug</button>
        <button class="month-btn" onclick="filterByMonth('09')" data-month="09">Sep</button>
        <button class="month-btn" onclick="filterByMonth('10')" data-month="10">Okt</button>
        <button class="month-btn" onclick="filterByMonth('11')" data-month="11">Nov</button>
        <button class="month-btn" onclick="filterByMonth('12')" data-month="12">Dez</button>
      </div>
    </div>

    <!-- Toggle Tabelle -->
    <div class="table-toggle" id="tableToggle" style="display:none;">
      <button class="toggle-btn" onclick="toggleTable()">📋 Details anzeigen</button>
    </div>

    <!-- Tabelle -->
    <div class="table-container" id="tableContainer">
      <table id="expenseTable">
        <thead>
          <tr>
            <th>Datum</th>
            <th>Artikel</th>
            <th>Kategorie</th>
            <th>Preis (€)</th>
            <th>Shop</th>
          </tr>
        </thead>
        <tbody id="tableBody"></tbody>
      </table>
    </div>

    <div id="noData" class="no-data"><em>Keine Daten geladen.</em></div>

    <!-- Zusammenfassung -->
    <div class="summary-section" id="summarySection" style="display:none;">
      <h2>📊 Zusammenfassung nach Kategorien</h2>
      <div class="summary-grid" id="summaryGrid"></div>
      <div class="total-summary">
        <h2>💰 Gesamtausgaben</h2>
        <div class="amount" id="totalSum">0,00 €</div>
        <p id="dateRange">Zeitraum: -</p>
      </div>
    </div>

    <!-- Chart -->
    <div class="chart-section" id="chartSection" style="display:none;">
      <h2>🏪 Ausgaben nach Shops</h2>
      <div class="chart-container">
        <canvas id="shopChart" width="400" height="400"></canvas>
      </div>
    </div>
  </div>

  <!-- JS -->
  <script src="script.js"></script>
</body>
</html>
